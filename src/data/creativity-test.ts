/**
 * Тест на креативность
 * Оценивает творческий потенциал, стиль мышления и креативные способности
 */

export interface CreativityQuestion {
  id: string;
  text: string;
  category: 'divergent' | 'convergent' | 'artistic' | 'innovative' | 'adaptive';
  options: {
    text: string;
    score: number; // 1 (низкая креативность) до 4 (высокая креативность)
  }[];
}

export interface CreativityResult {
  overall_level: 'low' | 'moderate' | 'high' | 'exceptional';
  total_score: number; // от 22 до 88
  percentage: number; // 0-100
  title: string;
  description: string;
  creativity_type: 'analytical' | 'artistic' | 'practical' | 'innovative' | 'adaptive';
  category_scores: {
    divergent: number;    // Дивергентное мышление
    convergent: number;   // Конвергентное мышление
    artistic: number;     // Художественная креативность
    innovative: number;   // Инновационное мышление
    adaptive: number;     // Адаптивная креативность
  };
  strengths: string[];
  creative_traits: string[];
  barriers: string[];
  development_areas: string[];
  enhancement_strategies: string[];
  creative_exercises: string[];
  career_suggestions: string[];
  famous_examples: string[];
}

export const creativityQuestions: CreativityQuestion[] = [
  {
    id: '1',
    text: 'Когда вы сталкиваетесь с проблемой, вы склонны:',
    category: 'divergent',
    options: [
      { text: 'Искать один правильный ответ', score: 1 },
      { text: 'Рассматривать несколько вариантов решения', score: 2 },
      { text: 'Генерировать множество идей, даже необычных', score: 3 },
      { text: 'Придумывать совершенно нестандартные подходы', score: 4 }
    ]
  },
  {
    id: '2',
    text: 'Как часто вы занимаетесь творческими видами деятельности?',
    category: 'artistic',
    options: [
      { text: 'Практически никогда', score: 1 },
      { text: 'Изредка, когда есть время', score: 2 },
      { text: 'Регулярно, это важная часть моей жизни', score: 3 },
      { text: 'Ежедневно, не могу без творчества', score: 4 }
    ]
  },
  {
    id: '3',
    text: 'Когда вам нужно найти практическое решение, вы:',
    category: 'convergent',
    options: [
      { text: 'Полагаетесь на проверенные методы', score: 1 },
      { text: 'Анализируете факты и выбираете лучший вариант', score: 2 },
      { text: 'Комбинируете разные подходы для оптимального решения', score: 3 },
      { text: 'Создаете инновационные решения на основе анализа', score: 4 }
    ]
  },
  {
    id: '4',
    text: 'Как вы относитесь к новым технологиям и трендам?',
    category: 'innovative',
    options: [
      { text: 'Осторожно, предпочитаю проверенное', score: 1 },
      { text: 'Изучаю, когда они становятся популярными', score: 2 },
      { text: 'Активно интересуюсь и быстро осваиваю', score: 3 },
      { text: 'Часто первым пробую и даже создаю новое', score: 4 }
    ]
  },
  {
    id: '5',
    text: 'Когда планы резко меняются, вы:',
    category: 'adaptive',
    options: [
      { text: 'Испытываете стресс и трудности с адаптацией', score: 1 },
      { text: 'Нужно время, чтобы приспособиться', score: 2 },
      { text: 'Довольно легко находите новые решения', score: 3 },
      { text: 'Воспринимаете как возможность для чего-то лучшего', score: 4 }
    ]
  },
  {
    id: '6',
    text: 'Ваше рабочее пространство обычно:',
    category: 'artistic',
    options: [
      { text: 'Строго организованное и минималистичное', score: 1 },
      { text: 'Функциональное с личными элементами', score: 2 },
      { text: 'Творческое с интересными деталями', score: 3 },
      { text: 'Хаотично-креативное, полное вдохновляющих объектов', score: 4 }
    ]
  },
  {
    id: '7',
    text: 'При мозговом штурме вы обычно:',
    category: 'divergent',
    options: [
      { text: 'Предлагаете несколько логичных идей', score: 1 },
      { text: 'Генерируете разнообразные варианты', score: 2 },
      { text: 'Придумываете множество оригинальных идей', score: 3 },
      { text: 'Предлагаете самые неожиданные и смелые концепции', score: 4 }
    ]
  },
  {
    id: '8',
    text: 'Как вы учитесь новому?',
    category: 'adaptive',
    options: [
      { text: 'По инструкциям и четким алгоритмам', score: 1 },
      { text: 'Комбинирую теорию и практику', score: 2 },
      { text: 'Экспериментирую и ищу свои методы', score: 3 },
      { text: 'Создаю собственные уникальные подходы к обучению', score: 4 }
    ]
  },
  {
    id: '9',
    text: 'Ваш подход к решению сложных задач:',
    category: 'convergent',
    options: [
      { text: 'Разделяю на простые части и решаю поэтапно', score: 1 },
      { text: 'Анализирую и выбираю лучший метод', score: 2 },
      { text: 'Использую различные стратегии в зависимости от задачи', score: 3 },
      { text: 'Изобретаю новые методы решения для каждой задачи', score: 4 }
    ]
  },
  {
    id: '10',
    text: 'Как часто у вас возникают неожиданные идеи?',
    category: 'innovative',
    options: [
      { text: 'Редко, обычно мыслю стандартно', score: 1 },
      { text: 'Иногда приходят интересные мысли', score: 2 },
      { text: 'Регулярно генерирую новые идеи', score: 3 },
      { text: 'Постоянно, идеи приходят в самых неожиданных моментах', score: 4 }
    ]
  },
  {
    id: '11',
    text: 'Когда вы видите произведение искусства, вы:',
    category: 'artistic',
    options: [
      { text: 'Оцениваете его с практической точки зрения', score: 1 },
      { text: 'Анализируете технику и стиль', score: 2 },
      { text: 'Чувствуете эмоциональный отклик и вдохновение', score: 3 },
      { text: 'Видите множество интерпретаций и хочется создать что-то свое', score: 4 }
    ]
  },
  {
    id: '12',
    text: 'Ваше отношение к рутинным задачам:',
    category: 'innovative',
    options: [
      { text: 'Выполняю их стандартным способом', score: 1 },
      { text: 'Стараюсь делать их эффективно', score: 2 },
      { text: 'Ищу способы сделать их интереснее', score: 3 },
      { text: 'Постоянно изобретаю новые способы их выполнения', score: 4 }
    ]
  },
  {
    id: '13',
    text: 'В групповых проектах вы часто:',
    category: 'divergent',
    options: [
      { text: 'Следуете установленному плану', score: 1 },
      { text: 'Предлагаете улучшения к существующим идеям', score: 2 },
      { text: 'Генерируете альтернативные подходы', score: 3 },
      { text: 'Предлагаете радикально новые направления', score: 4 }
    ]
  },
  {
    id: '14',
    text: 'Как вы относитесь к ошибкам в творческом процессе?',
    category: 'adaptive',
    options: [
      { text: 'Стараюсь их избегать любой ценой', score: 1 },
      { text: 'Исправляю и продолжаю работу', score: 2 },
      { text: 'Воспринимаю как часть процесса обучения', score: 3 },
      { text: 'Использую их как источник новых идей и направлений', score: 4 }
    ]
  },
  {
    id: '15',
    text: 'Ваши хобби и интересы:',
    category: 'artistic',
    options: [
      { text: 'Практичные и связанные с профессией', score: 1 },
      { text: 'Разнообразные, но в рамках привычного', score: 2 },
      { text: 'Включают творческие и необычные направления', score: 3 },
      { text: 'Постоянно меняются, люблю пробовать новое', score: 4 }
    ]
  },
  {
    id: '16',
    text: 'При принятии важных решений вы:',
    category: 'convergent',
    options: [
      { text: 'Полагаетесь на логику и факты', score: 1 },
      { text: 'Взвешиваете все плюсы и минусы', score: 2 },
      { text: 'Учитываете как рациональные, так и интуитивные факторы', score: 3 },
      { text: 'Создаете инновационные критерии для оценки вариантов', score: 4 }
    ]
  },
  {
    id: '17',
    text: 'Как вы генерируете идеи для подарков?',
    category: 'innovative',
    options: [
      { text: 'Покупаю что-то практичное или популярное', score: 1 },
      { text: 'Выбираю исходя из интересов человека', score: 2 },
      { text: 'Стараюсь найти что-то особенное и необычное', score: 3 },
      { text: 'Создаю персонализированные или самодельные подарки', score: 4 }
    ]
  },
  {
    id: '18',
    text: 'Ваш стиль одежды:',
    category: 'artistic',
    options: [
      { text: 'Классический и консервативный', score: 1 },
      { text: 'Практичный с элементами стиля', score: 2 },
      { text: 'Отражает мою индивидуальность', score: 3 },
      { text: 'Экспериментальный, люблю создавать уникальные образы', score: 4 }
    ]
  },
  {
    id: '19',
    text: 'Когда у вас есть свободное время, вы предпочитаете:',
    category: 'divergent',
    options: [
      { text: 'Заниматься привычными делами', score: 1 },
      { text: 'Планировать полезные активности', score: 2 },
      { text: 'Исследовать новые интересы', score: 3 },
      { text: 'Спонтанно следовать вдохновению куда угодно', score: 4 }
    ]
  },
  {
    id: '20',
    text: 'Ваш подход к планированию:',
    category: 'adaptive',
    options: [
      { text: 'Детальные планы с четкими сроками', score: 1 },
      { text: 'Общие планы с возможностью корректировок', score: 2 },
      { text: 'Гибкие рамки с местом для спонтанности', score: 3 },
      { text: 'Минимальное планирование, предпочитаю импровизацию', score: 4 }
    ]
  },
  {
    id: '21',
    text: 'Как вы реагируете на критику своих идей?',
    category: 'convergent',
    options: [
      { text: 'Принимаю к сведению и корректирую', score: 1 },
      { text: 'Анализирую обоснованность и вношу изменения', score: 2 },
      { text: 'Использую как стимул для улучшения идеи', score: 3 },
      { text: 'Воспринимаю как возможность создать что-то еще лучше', score: 4 }
    ]
  },
  {
    id: '22',
    text: 'В конфликтных ситуациях вы склонны:',
    category: 'innovative',
    options: [
      { text: 'Придерживаться стандартных способов решения', score: 1 },
      { text: 'Искать компромиссные решения', score: 2 },
      { text: 'Предлагать альтернативные пути разрешения', score: 3 },
      { text: 'Находить совершенно новые подходы к решению конфликта', score: 4 }
    ]
  }
];

export const calculateCreativityResult = (answers: Record<string, number>): CreativityResult => {
  const total_score = Object.values(answers).reduce((sum, score) => sum + score, 0);
  const percentage = Math.round(((total_score - 22) / 66) * 100);

  // Подсчет баллов по категориям
  const category_scores = {
    divergent: 0,
    convergent: 0,
    artistic: 0,
    innovative: 0,
    adaptive: 0
  };

  const categoryCount = {
    divergent: 0,
    convergent: 0,
    artistic: 0,
    innovative: 0,
    adaptive: 0
  };

  creativityQuestions.forEach((question) => {
    const answer = answers[question.id];
    if (answer !== undefined) {
      category_scores[question.category] += answer;
      categoryCount[question.category]++;
    }
  });

  // Нормализуем оценки по категориям
  Object.keys(category_scores).forEach((category) => {
    const key = category as keyof typeof category_scores;
    category_scores[key] = Math.round((category_scores[key] / categoryCount[key]) * 25);
  });

  // Определяем тип креативности
  const maxCategory = Object.entries(category_scores).reduce((max, [key, value]) => 
    value > max.value ? { key: key as keyof typeof category_scores, value } : max
  , { key: 'artistic' as keyof typeof category_scores, value: 0 });

  const creativity_type_mapping = {
    divergent: 'innovative',
    convergent: 'analytical',
    artistic: 'artistic',
    innovative: 'innovative',
    adaptive: 'adaptive'
  } as const;

  const creativity_type = creativity_type_mapping[maxCategory.key] || 'artistic';

  let overall_level: 'low' | 'moderate' | 'high' | 'exceptional';
  let title: string;
  let description: string;
  let strengths: string[];
  let creative_traits: string[];
  let barriers: string[];
  let development_areas: string[];
  let enhancement_strategies: string[];
  let creative_exercises: string[];
  let career_suggestions: string[];
  let famous_examples: string[];

  if (total_score <= 35) {
    overall_level = 'low';
    title = 'Развивающийся творческий потенциал';
    description = 'У вас есть основа для развития творческих способностей. Хотя сейчас вы склонны к более традиционным подходам, с практикой и открытостью новому опыту ваша креативность может значительно возрасти.';
    strengths = [
      'Логическое мышление',
      'Практический подход',
      'Надежность в выполнении задач',
      'Способность следовать инструкциям'
    ];
    creative_traits = [
      'Периодические творческие порывы',
      'Способность к адаптации при необходимости',
      'Потенциал для развития'
    ];
    barriers = [
      'Страх ошибок и экспериментов',
      'Предпочтение проверенных методов',
      'Недостаток уверенности в творческих способностях',
      'Ограниченный опыт творческой деятельности'
    ];
    development_areas = [
      'Открытость новому опыту',
      'Развитие воображения',
      'Преодоление страха неудач',
      'Экспериментирование с новыми подходами'
    ];
  } else if (total_score <= 55) {
    overall_level = 'moderate';
    title = 'Умеренная креативность';
    description = 'Вы обладаете хорошими творческими способностями и способны находить оригинальные решения. Ваша креативность проявляется в определенных ситуациях, и с развитием она может стать еще более выраженной.';
    strengths = [
      'Баланс между логикой и творчеством',
      'Способность к адаптации',
      'Генерирование интересных идей',
      'Открытость к новым подходам'
    ];
    creative_traits = [
      'Гибкость мышления',
      'Способность видеть альтернативы',
      'Периодические вспышки вдохновения',
      'Интерес к творческим процессам'
    ];
    barriers = [
      'Периодическая критичность к своим идеям',
      'Предпочтение безопасных решений в важных вопросах',
      'Недостаток времени для творческой деятельности'
    ];
    development_areas = [
      'Увеличение времени для творческой практики',
      'Развитие уверенности в своих идеях',
      'Изучение новых техник креативности',
      'Расширение творческого опыта'
    ];
  } else if (total_score <= 75) {
    overall_level = 'high';
    title = 'Высокая креативность';
    description = 'У вас ярко выраженные творческие способности. Вы естественно генерируете оригинальные идеи, любите экспериментировать и не боитесь нестандартных решений. Ваша креативность является значительным преимуществом в жизни и работе.';
    strengths = [
      'Богатое воображение',
      'Способность к инновациям',
      'Гибкое и оригинальное мышление',
      'Комфорт с неопределенностью',
      'Способность видеть связи между разными идеями'
    ];
    creative_traits = [
      'Постоянный поток новых идей',
      'Любовь к экспериментам',
      'Способность к импровизации',
      'Уникальный взгляд на мир',
      'Вдохновение от разнообразных источников'
    ];
    barriers = [
      'Иногда слишком много идей одновременно',
      'Трудности с выбором лучшего решения',
      'Возможное сопротивление окружающих к новым идеям'
    ];
    development_areas = [
      'Развитие навыков реализации идей',
      'Обучение приоритизации проектов',
      'Совершенствование коммуникации идей',
      'Поиск единомышленников'
    ];
  } else {
    overall_level = 'exceptional';
    title = 'Исключительная креативность';
    description = 'Вы обладаете выдающимися творческими способностями. Ваше мышление отличается высокой оригинальностью, вы постоянно генерируете инновационные идеи и способны кардинально переосмыслить привычные подходы. Ваша креативность может быть источником значительных достижений.';
    strengths = [
      'Революционное мышление',
      'Исключительное воображение',
      'Способность к парадигмальным сдвигам',
      'Высокая толерантность к амбивалентности',
      'Синтез разнородных идей'
    ];
    creative_traits = [
      'Постоянное стремление к инновациям',
      'Уникальный творческий стиль',
      'Способность вдохновлять других',
      'Видение возможностей там, где другие их не замечают',
      'Естественная креативность во всех сферах жизни'
    ];
    barriers = [
      'Возможное непонимание со стороны окружающих',
      'Трудности с фокусировкой на одном проекте',
      'Риск перфекционизма в творческих проектах'
    ];
    development_areas = [
      'Развитие лидерских навыков',
      'Построение команды единомышленников',
      'Обучение монетизации творческих способностей',
      'Развитие дисциплины в реализации идей'
    ];
  }

  // Стратегии развития креативности
  enhancement_strategies = [
    'Ведите журнал идей - записывайте все, что приходит в голову',
    'Практикуйте мозговой штурм регулярно',
    'Изучайте новые области знаний для расширения кругозора',
    'Экспериментируйте с различными творческими техниками',
    'Окружите себя вдохновляющими объектами и людьми',
    'Выделяйте время для размышлений и медитации',
    'Ищите неожиданные связи между разными идеями'
  ];

  // Упражнения для развития креативности
  creative_exercises = [
    'Техника "6 шляп мышления" Эдварда де Боно',
    'Морфологический анализ - разложение проблемы на части',
    'Метод аналогий - поиск решений в других областях',
    'Фрирайтинг - свободное письмо без критики',
    'Визуальные карты ассоциаций (mind mapping)',
    'Техника "Что если?" - исследование альтернативных сценариев',
    'Ролевая игра - взгляд на проблему с разных точек зрения'
  ];

  // Карьерные предложения на основе типа креативности
  switch (creativity_type) {
    case 'analytical':
      career_suggestions = [
        'Исследователь или ученый',
        'Системный аналитик',
        'UX/UI дизайнер',
        'Архитектор решений',
        'Консультант по оптимизации процессов'
      ];
      famous_examples = ['Альберт Эйнштейн', 'Мария Кюри', 'Стив Джобс'];
      break;
    case 'artistic':
      career_suggestions = [
        'Художник, дизайнер, иллюстратор',
        'Писатель, сценарист',
        'Музыкант, композитор',
        'Фотограф, режиссер',
        'Арт-директор'
      ];
      famous_examples = ['Леонардо да Винчи', 'Фрида Кало', 'Дэвид Боуи'];
      break;
    case 'practical':
      career_suggestions = [
        'Продуктовый менеджер',
        'Предприниматель',
        'Инженер-изобретатель',
        'Организатор мероприятий',
        'Социальный инноватор'
      ];
      famous_examples = ['Илон Маск', 'Опра Уинфри', 'Ричард Брэнсон'];
      break;
    case 'innovative':
      career_suggestions = [
        'Стартапер, основатель компании',
        'Исследователь и разработчик',
        'Футуролог, стратегический планировщик',
        'Технологический евангелист',
        'Креативный директор'
      ];
      famous_examples = ['Никола Тесла', 'Стив Возняк', 'Сергей Брин'];
      break;
    case 'adaptive':
      career_suggestions = [
        'Кризисный менеджер',
        'Фрилансер мультидисциплинарный',
        'Тренер по развитию',
        'Путешественник-блогер',
        'Консультант по изменениям'
      ];
      famous_examples = ['Ричард Фейнман', 'Майя Анджелоу', 'Тим Феррис'];
      break;
  }

  return {
    overall_level,
    total_score,
    percentage,
    title,
    description,
    creativity_type,
    category_scores,
    strengths,
    creative_traits,
    barriers,
    development_areas,
    enhancement_strategies,
    creative_exercises,
    career_suggestions,
    famous_examples
  };
};