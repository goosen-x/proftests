/**
 * Тест на языки любви
 * Определяет основной способ выражения и восприятия любви согласно теории Гэри Чепмена
 */

export interface LoveLanguageQuestion {
  id: string;
  text: string;
  options: {
    text: string;
    type: 'words' | 'acts' | 'gifts' | 'time' | 'touch'; // 5 языков любви
  }[];
}

export interface LoveLanguageResult {
  primary_language: 'words' | 'acts' | 'gifts' | 'time' | 'touch';
  secondary_language?: 'words' | 'acts' | 'gifts' | 'time' | 'touch';
  scores: {
    words: number; // Слова поддержки
    acts: number;  // Дела заботы
    gifts: number; // Подарки
    time: number;  // Качественное время
    touch: number; // Физическое прикосновение
  };
  percentages: {
    words: number;
    acts: number;
    gifts: number;
    time: number;
    touch: number;
  };
  title: string;
  description: string;
  characteristics: string[];
  how_to_receive_love: string[];
  how_to_give_love: string[];
  partner_advice: string[];
  common_misunderstandings: string[];
  growth_tips: string[];
}

export const loveLanguageQuestions: LoveLanguageQuestion[] = [
  {
    id: '1',
    text: 'Что больше всего заставляет вас чувствовать себя любимым?',
    options: [
      { text: 'Когда партнер говорит "Я тебя люблю" и делает комплименты', type: 'words' },
      { text: 'Когда партнер помогает с домашними делами без просьб', type: 'acts' },
      { text: 'Когда партнер дарит подарки или сюрпризы', type: 'gifts' },
      { text: 'Когда партнер проводит со мной время, не отвлекаясь на телефон', type: 'time' },
      { text: 'Когда партнер обнимает, целует и прикасается ко мне', type: 'touch' }
    ]
  },
  {
    id: '2',
    text: 'Что вас больше всего расстраивает в отношениях?',
    options: [
      { text: 'Критика и негативные комментарии в мой адрес', type: 'words' },
      { text: 'Когда партнер не помогает и перекладывает всё на меня', type: 'acts' },
      { text: 'Забытые важные даты и отсутствие подарков', type: 'gifts' },
      { text: 'Постоянная занятость партнера и нехватка времени вместе', type: 'time' },
      { text: 'Отсутствие физической близости и нежности', type: 'touch' }
    ]
  },
  {
    id: '3',
    text: 'Как вы предпочитаете показывать свою любовь?',
    options: [
      { text: 'Говорю слова поддержки и признания в любви', type: 'words' },
      { text: 'Делаю что-то полезное для партнера', type: 'acts' },
      { text: 'Покупаю подарки и делаю сюрпризы', type: 'gifts' },
      { text: 'Планирую совместные активности и время вдвоем', type: 'time' },
      { text: 'Обнимаю, целую и выражаю любовь прикосновениями', type: 'touch' }
    ]
  },
  {
    id: '4',
    text: 'Что для вас означает романтичный вечер?',
    options: [
      { text: 'Душевная беседа с комплиментами и признаниями', type: 'words' },
      { text: 'Когда партнер приготовил ужин и убрал всё сам', type: 'acts' },
      { text: 'Красивые цветы, подарок или сюрприз', type: 'gifts' },
      { text: 'Время наедине без отвлечений, полное внимание друг к другу', type: 'time' },
      { text: 'Близость, объятия и нежные прикосновения', type: 'touch' }
    ]
  },
  {
    id: '5',
    text: 'Когда вы ссоритесь с партнером, что поможет вам помириться?',
    options: [
      { text: 'Искренние извинения и слова о том, как я важен', type: 'words' },
      { text: 'Конкретные действия, показывающие изменения', type: 'acts' },
      { text: 'Символический подарок как знак примирения', type: 'gifts' },
      { text: 'Спокойный разговор и время, чтобы всё обсудить', type: 'time' },
      { text: 'Объятия и физическая близость', type: 'touch' }
    ]
  },
  {
    id: '6',
    text: 'Что вас больше всего радует в отношениях?',
    options: [
      { text: 'Когда партнер хвалит меня при других людях', type: 'words' },
      { text: 'Когда партнер замечает, что нужно сделать, и делает это', type: 'acts' },
      { text: 'Неожиданные подарки "просто так"', type: 'gifts' },
      { text: 'Долгие прогулки и разговоры о жизни', type: 'time' },
      { text: 'Спонтанные объятия и поцелуи в течение дня', type: 'touch' }
    ]
  },
  {
    id: '7',
    text: 'Как вы понимаете, что партнер действительно вас любит?',
    options: [
      { text: 'По тому, как он говорит обо мне и со мной', type: 'words' },
      { text: 'По его действиям и тому, что он для меня делает', type: 'acts' },
      { text: 'По подаркам и знакам внимания', type: 'gifts' },
      { text: 'По тому, сколько времени он готов со мной проводить', type: 'time' },
      { text: 'По физической близости и нежности', type: 'touch' }
    ]
  },
  {
    id: '8',
    text: 'Что для вас идеальное проявление заботы в болезни?',
    options: [
      { text: 'Слова поддержки: "Ты справишься", "Я рядом"', type: 'words' },
      { text: 'Практическая помощь: приносит лекарства, готовит еду', type: 'acts' },
      { text: 'Покупает что-то особенное для выздоровления', type: 'gifts' },
      { text: 'Проводит время рядом, не оставляет одного', type: 'time' },
      { text: 'Гладит по голове, массирует, обнимает', type: 'touch' }
    ]
  },
  {
    id: '9',
    text: 'Какой комплимент вас больше всего тронет?',
    options: [
      { text: '"Ты самый лучший человек в моей жизни"', type: 'words' },
      { text: '"Ты так много для меня делаешь"', type: 'acts' },
      { text: 'Подарок с запиской "Потому что ты этого достоин"', type: 'gifts' },
      { text: '"Я так ценю каждую минуту, проведенную с тобой"', type: 'time' },
      { text: 'Долгие объятия со словами "Я так скучаю по тебе"', type: 'touch' }
    ]
  },
  {
    id: '10',
    text: 'Что заставляет вас почувствовать себя особенным?',
    options: [
      { text: 'Когда партнер рассказывает другим, какой я замечательный', type: 'words' },
      { text: 'Когда партнер делает что-то сложное специально для меня', type: 'acts' },
      { text: 'Персонализированный подарок, показывающий, что партнер меня знает', type: 'gifts' },
      { text: 'Когда партнер отменяет другие планы, чтобы побыть со мной', type: 'time' },
      { text: 'Нежные прикосновения и близость в течение дня', type: 'touch' }
    ]
  },
  {
    id: '11',
    text: 'Как вы предпочитаете отмечать важные события?',
    options: [
      { text: 'Тостами, речами и словами о том, как это важно', type: 'words' },
      { text: 'Когда кто-то организует всё и берет заботы на себя', type: 'acts' },
      { text: 'Особенными подарками и сюрпризами', type: 'gifts' },
      { text: 'Качественным временем с близкими людьми', type: 'time' },
      { text: 'Объятиями, поцелуями и физической близостью', type: 'touch' }
    ]
  },
  {
    id: '12',
    text: 'Что для вас означает поддержка в трудные времена?',
    options: [
      { text: 'Слова ободрения и вера в мои способности', type: 'words' },
      { text: 'Конкретная помощь в решении проблем', type: 'acts' },
      { text: 'Что-то особенное, чтобы поднять настроение', type: 'gifts' },
      { text: 'Время, чтобы выговориться и получить внимание', type: 'time' },
      { text: 'Объятия и физическое утешение', type: 'touch' }
    ]
  },
  {
    id: '13',
    text: 'Когда вы чувствуете наибольшую связь с партнером?',
    options: [
      { text: 'Когда мы говорим о своих чувствах друг к другу', type: 'words' },
      { text: 'Когда мы вместе работаем над общими задачами', type: 'acts' },
      { text: 'Когда мы дарим друг другу подарки', type: 'gifts' },
      { text: 'Когда мы проводим время, полностью сосредоточившись друг на друге', type: 'time' },
      { text: 'Когда мы физически близки друг к другу', type: 'touch' }
    ]
  },
  {
    id: '14',
    text: 'Какой способ извинений вам ближе?',
    options: [
      { text: 'Искренние слова: "Прости, я был неправ"', type: 'words' },
      { text: 'Исправление ситуации конкретными действиями', type: 'acts' },
      { text: 'Символический подарок в знак раскаяния', type: 'gifts' },
      { text: 'Время, чтобы всё спокойно обсудить', type: 'time' },
      { text: 'Примиряющие объятия и близость', type: 'touch' }
    ]
  },
  {
    id: '15',
    text: 'Что заставляет вас чувствовать себя любимым в долгосрочных отношениях?',
    options: [
      { text: 'Постоянные напоминания о том, как я важен', type: 'words' },
      { text: 'Ежедневная помощь и поддержка в делах', type: 'acts' },
      { text: 'Регулярные подарки и знаки внимания', type: 'gifts' },
      { text: 'Качественное время вместе каждый день', type: 'time' },
      { text: 'Постоянная физическая близость и нежность', type: 'touch' }
    ]
  }
];

export const calculateLoveLanguageResult = (answers: Record<string, string>): LoveLanguageResult => {
  const scores = {
    words: 0,
    acts: 0,
    gifts: 0,
    time: 0,
    touch: 0
  };

  // Подсчитываем баллы для каждого языка любви
  Object.values(answers).forEach((type) => {
    scores[type as keyof typeof scores]++;
  });

  // Находим основной и вторичный языки любви
  const sortedScores = Object.entries(scores).sort((a, b) => b[1] - a[1]);
  const primary_language = sortedScores[0][0] as keyof typeof scores;
  const secondary_language = sortedScores[1][1] > 0 ? sortedScores[1][0] as keyof typeof scores : undefined;

  // Вычисляем проценты
  const totalAnswers = Object.keys(answers).length;
  const percentages = {
    words: Math.round((scores.words / totalAnswers) * 100),
    acts: Math.round((scores.acts / totalAnswers) * 100),
    gifts: Math.round((scores.gifts / totalAnswers) * 100),
    time: Math.round((scores.time / totalAnswers) * 100),
    touch: Math.round((scores.touch / totalAnswers) * 100)
  };

  let title: string;
  let description: string;
  let characteristics: string[];
  let how_to_receive_love: string[];
  let how_to_give_love: string[];
  let partner_advice: string[];
  let common_misunderstandings: string[];
  let growth_tips: string[];

  switch (primary_language) {
    case 'words':
      title = 'Слова поддержки';
      description = 'Ваш основной язык любви - это слова поддержки. Вы чувствуете себя любимым, когда слышите искренние комплименты, слова благодарности и признания в любви. Для вас важны не только слова "я тебя люблю", но и конкретные комплименты о ваших качествах и достижениях.';
      characteristics = [
        'Ценят устные и письменные слова поддержки',
        'Болезненно реагируют на критику и негативные комментарии',
        'Любят получать комплименты и признание',
        'Запоминают как позитивные, так и негативные слова надолго',
        'Выражают любовь через слова благодарности и похвалы'
      ];
      how_to_receive_love = [
        'Просите партнера чаще говорить, что он вас ценит',
        'Объясните, какие именно слова вам приятно слышать',
        'Попросите оставлять записки с комплиментами',
        'Поделитесь важностью устной поддержки'
      ];
      how_to_give_love = [
        'Регулярно говорите комплименты и слова благодарности',
        'Пишите любовные записки и сообщения',
        'Публично хвалите партнера',
        'Избегайте критики, выражайте недовольство мягко'
      ];
      partner_advice = [
        'Говорите "я тебя люблю" и объясняйте, за что именно',
        'Замечайте и озвучивайте положительные качества партнера',
        'Поддерживайте словами в трудные моменты',
        'Избегайте резких слов и критики'
      ];
      common_misunderstandings = [
        'Думают, что действия важнее слов',
        'Не понимают, почему нужно говорить очевидные вещи',
        'Считают комплименты неискренними или ненужными',
        'Недооценивают силу воздействия негативных слов'
      ];
      growth_tips = [
        'Учитесь выражать благодарность конкретными словами',
        'Практикуйте ежедневные комплименты',
        'Развивайте эмоциональный словарь',
        'Изучайте, как правильно критиковать конструктивно'
      ];
      break;

    case 'acts':
      title = 'Дела заботы';
      description = 'Ваш основной язык любви - это дела заботы. Вы чувствуете любовь через действия партнера. Для вас фраза "действия говорят громче слов" особенно актуальна. Помощь по дому, забота о ваших потребностях и решение проблем - вот что заставляет вас чувствовать себя любимым.';
      characteristics = [
        'Ценят практическую помощь и поддержку',
        'Обращают внимание на то, что партнер делает, а не говорит',
        'Чувствуют любовь через заботу о бытовых вопросах',
        'Расстраиваются, когда партнер не помогает',
        'Сами выражают любовь через полезные действия'
      ];
      how_to_receive_love = [
        'Конкретно просите о помощи в делах',
        'Объясните, какие действия для вас особенно значимы',
        'Благодарите за помощь, чтобы мотивировать продолжать',
        'Составьте список дел, в которых нужна помощь'
      ];
      how_to_give_love = [
        'Помогайте с домашними делами без просьб',
        'Решайте проблемы и упрощайте жизнь партнера',
        'Берите на себя обязанности партнера, когда он устал',
        'Обращайте внимание на потребности и действуйте'
      ];
      partner_advice = [
        'Помогайте по дому и не ждите просьб',
        'Замечайте, что нужно сделать, и делайте это',
        'Берите на себя заботы, которые обычно решает партнер',
        'Маленькие ежедневные дела важнее редких больших жестов'
      ];
      common_misunderstandings = [
        'Думают, что слова любви достаточно без действий',
        'Не понимают важности помощи в "мелочах"',
        'Считают, что партнер должен просить о помощи',
        'Недооценивают эмоциональное значение бытовой помощи'
      ];
      growth_tips = [
        'Учитесь замечать, что нужно сделать',
        'Составьте список дел, которые можно взять на себя',
        'Развивайте привычку помогать без просьб',
        'Изучайте потребности партнера в практической помощи'
      ];
      break;

    case 'gifts':
      title = 'Подарки';
      description = 'Ваш основной язык любви - это подарки. Для вас важны не дорогие подарки, а внимание и забота, которые они символизируют. Подарок - это физическое выражение любви, напоминание о том, что вы важны. Цена не имеет значения, важна мысль и время, потраченное на выбор.';
      characteristics = [
        'Ценят подарки как символы любви и внимания',
        'Помнят все подарки и их значение',
        'Расстраиваются из-за забытых важных дат',
        'Любят делать подарки другим людям',
        'Обращают внимание на усилия, потраченные на выбор подарка'
      ];
      how_to_receive_love = [
        'Объясните, что подарки важны для вас',
        'Составьте wishlist желаемых подарков',
        'Благодарите за любые подарки, даже самые маленькие',
        'Делитесь тем, какие подарки вам особенно дороги'
      ];
      how_to_give_love = [
        'Дарите подарки регулярно, не только по праздникам',
        'Выбирайте персонализированные подарки',
        'Обращайте внимание на то, что нравится партнеру',
        'Маленькие знаки внимания лучше редких дорогих подарков'
      ];
      partner_advice = [
        'Не забывайте важные даты и события',
        'Дарите подарки "просто так", без повода',
        'Выбирайте подарки, показывающие что вы знаете партнера',
        'Внимание и мысль важнее цены подарка'
      ];
      common_misunderstandings = [
        'Думают, что важна только цена подарка',
        'Считают подарки материалистичными или поверхностными',
        'Не понимают символического значения подарков',
        'Забывают о важности регулярных маленьких знаков внимания'
      ];
      growth_tips = [
        'Изучайте интересы и предпочтения партнера',
        'Ведите список идей для подарков',
        'Развивайте креативность в выборе подарков',
        'Учитесь замечать, что может порадовать партнера'
      ];
      break;

    case 'time':
      title = 'Качественное время';
      description = 'Ваш основной язык любви - это качественное время. Вы чувствуете себя любимым, когда партнер дает вам свое полное внимание. Для вас важно не просто физическое присутствие, а эмоциональная доступность и концентрация на ваших отношениях. Совместные активности и глубокие разговоры наполняют вас любовью.';
      characteristics = [
        'Ценят полное внимание и сосредоточенность партнера',
        'Любят совместные активности и разговоры',
        'Расстраиваются, когда партнер отвлекается во время общения',
        'Планируют совместное время как приоритет',
        'Чувствуют себя любимыми через присутствие партнера'
      ];
      how_to_receive_love = [
        'Планируйте регулярное время только для вас двоих',
        'Просите убрать телефоны во время общения',
        'Предлагайте совместные активности',
        'Объясните важность качества времени над количеством'
      ];
      how_to_give_love = [
        'Планируйте регулярные свидания и совместное время',
        'Убирайте отвлекающие факторы во время общения',
        'Инициируйте глубокие разговоры',
        'Участвуйте в активностях, которые нравятся партнеру'
      ];
      partner_advice = [
        'Давайте полное внимание во время общения',
        'Планируйте совместные активности регулярно',
        'Слушайте активно и участвуйте в разговорах',
        'Убирайте телефон и другие отвлекающие факторы'
      ];
      common_misunderstandings = [
        'Думают, что физическое присутствие равно качественному времени',
        'Не понимают важности полного внимания',
        'Считают достаточным просто находиться рядом',
        'Недооценивают потребность в глубоком общении'
      ];
      growth_tips = [
        'Практикуйте активное слушание',
        'Учитесь планировать совместное время',
        'Развивайте навыки глубокого общения',
        'Создавайте традиции совместного времяпрепровождения'
      ];
      break;

    case 'touch':
      title = 'Физическое прикосновение';
      description = 'Ваш основной язык любви - это физическое прикосновение. Объятия, поцелуи, держание за руки и другие формы физической близости заставляют вас чувствовать себя любимым и желанным. Для вас прикосновения - это мощный способ эмоциональной коммуникации и выражения любви.';
      characteristics = [
        'Ценят физическую близость и нежные прикосновения',
        'Чувствуют эмоциональную связь через физический контакт',
        'Страдают от недостатка физической близости',
        'Используют прикосновения для выражения эмоций',
        'Нуждаются в регулярном физическом контакте'
      ];
      how_to_receive_love = [
        'Объясните важность физической близости для вас',
        'Инициируйте прикосновения сами',
        'Просите о том виде близости, который вам нужен',
        'Создавайте моменты для физической близости'
      ];
      how_to_give_love = [
        'Обнимайте и целуйте партнера регулярно',
        'Держитесь за руки и касайтесь во время общения',
        'Предлагайте массаж и другие формы заботы через прикосновения',
        'Будьте физически доступны для близости'
      ];
      partner_advice = [
        'Не ограничивайтесь только интимностью',
        'Обнимайте и целуйте в течение дня',
        'Касайтесь во время разговоров',
        'Будьте инициатором физической близости'
      ];
      common_misunderstandings = [
        'Путают с желанием только интимной близости',
        'Недооценивают важность простых прикосновений',
        'Считают физическую близость менее важной чем слова',
        'Не понимают эмоциональной составляющей прикосновений'
      ];
      growth_tips = [
        'Изучайте различные формы здоровой физической близости',
        'Развивайте чувствительность к потребностям партнера',
        'Практикуйте нежные неинтимные прикосновения',
        'Учитесь выражать эмоции через физический контакт'
      ];
      break;
  }

  return {
    primary_language,
    secondary_language,
    scores,
    percentages,
    title,
    description,
    characteristics,
    how_to_receive_love,
    how_to_give_love,
    partner_advice,
    common_misunderstandings,
    growth_tips
  };
};