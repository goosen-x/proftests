/**
 * Тест на управление временем
 * Оценивает навыки планирования и эффективного использования времени
 */

export interface TimeManagementQuestion {
  id: string;
  text: string;
  options: {
    text: string;
    score: number; // 1 (плохо) до 4 (отлично)
  }[];
}

export interface TimeManagementResult {
  level: 'poor' | 'developing' | 'good' | 'excellent';
  score: number; // от 15 до 60
  percentage: number; // 0-100
  title: string;
  description: string;
  strengths: string[];
  weaknesses: string[];
  recommendations: string[];
  techniques: string[];
  tools: string[];
}

export const timeManagementQuestions: TimeManagementQuestion[] = [
  {
    id: '1',
    text: 'Как часто вы составляете план на день/неделю?',
    options: [
      { text: 'Никогда не планирую', score: 1 },
      { text: 'Иногда, когда много дел', score: 2 },
      { text: 'Регулярно планирую', score: 3 },
      { text: 'Всегда детально планирую', score: 4 }
    ]
  },
  {
    id: '2',
    text: 'Насколько хорошо вы оцениваете время, необходимое для выполнения задач?',
    options: [
      { text: 'Почти всегда ошибаюсь', score: 1 },
      { text: 'Часто недооцениваю время', score: 2 },
      { text: 'В основном оцениваю правильно', score: 3 },
      { text: 'Очень точно планирую время', score: 4 }
    ]
  },
  {
    id: '3',
    text: 'Как вы расставляете приоритеты в своих задачах?',
    options: [
      { text: 'Делаю что попало, без системы', score: 1 },
      { text: 'Стараюсь делать срочное первым', score: 2 },
      { text: 'Использую простую систему приоритетов', score: 3 },
      { text: 'Применяю четкую методику (Эйзенхауэр, ABC)', score: 4 }
    ]
  },
  {
    id: '4',
    text: 'Как часто вы отвлекаетесь во время работы?',
    options: [
      { text: 'Постоянно отвлекаюсь', score: 1 },
      { text: 'Часто теряю концентрацию', score: 2 },
      { text: 'Иногда отвлекаюсь', score: 3 },
      { text: 'Редко отвлекаюсь, хорошо концентрируюсь', score: 4 }
    ]
  },
  {
    id: '5',
    text: 'Как вы справляетесь с дедлайнами?',
    options: [
      { text: 'Часто нарушаю сроки', score: 1 },
      { text: 'Иногда опаздываю', score: 2 },
      { text: 'Обычно укладываюсь в срок', score: 3 },
      { text: 'Всегда сдаю работу вовремя или раньше', score: 4 }
    ]
  },
  {
    id: '6',
    text: 'Используете ли вы инструменты для планирования (календари, приложения)?',
    options: [
      { text: 'Не использую никаких инструментов', score: 1 },
      { text: 'Редко пользуюсь', score: 2 },
      { text: 'Регулярно использую простые инструменты', score: 3 },
      { text: 'Активно использую различные системы планирования', score: 4 }
    ]
  },
  {
    id: '7',
    text: 'Как вы относитесь к многозадачности?',
    options: [
      { text: 'Постоянно переключаюсь между задачами', score: 1 },
      { text: 'Часто делаю несколько дел одновременно', score: 2 },
      { text: 'Стараюсь сосредоточиться на одной задаче', score: 3 },
      { text: 'Принципиально работаю над одной задачей до завершения', score: 4 }
    ]
  },
  {
    id: '8',
    text: 'Как часто вы делаете перерывы в работе?',
    options: [
      { text: 'Работаю без перерывов до изнеможения', score: 1 },
      { text: 'Редко делаю перерывы', score: 2 },
      { text: 'Делаю перерывы когда устаю', score: 3 },
      { text: 'Регулярно планирую перерывы для поддержания эффективности', score: 4 }
    ]
  },
  {
    id: '9',
    text: 'Насколько хорошо вы умеете говорить "нет" дополнительным обязательствам?',
    options: [
      { text: 'Никогда не отказываюсь', score: 1 },
      { text: 'Очень редко отказываюсь', score: 2 },
      { text: 'Иногда отказываюсь', score: 3 },
      { text: 'Легко отказываюсь от неприоритетных дел', score: 4 }
    ]
  },
  {
    id: '10',
    text: 'Как вы планируете свое время на отдых и восстановление?',
    options: [
      { text: 'Не планирую отдых', score: 1 },
      { text: 'Отдыхаю только когда совсем устану', score: 2 },
      { text: 'Стараюсь найти время для отдыха', score: 3 },
      { text: 'Всегда планирую время для восстановления', score: 4 }
    ]
  },
  {
    id: '11',
    text: 'Как вы справляетесь с неожиданными задачами?',
    options: [
      { text: 'Они полностью нарушают мои планы', score: 1 },
      { text: 'С трудом встраиваю их в расписание', score: 2 },
      { text: 'Адаптирую планы под новые задачи', score: 3 },
      { text: 'Легко интегрирую неожиданные дела в план', score: 4 }
    ]
  },
  {
    id: '12',
    text: 'Анализируете ли вы, на что тратите время?',
    options: [
      { text: 'Никогда не анализирую', score: 1 },
      { text: 'Редко думаю об этом', score: 2 },
      { text: 'Иногда анализирую свое время', score: 3 },
      { text: 'Регулярно отслеживаю и анализирую время', score: 4 }
    ]
  },
  {
    id: '13',
    text: 'Как вы группируете похожие задачи?',
    options: [
      { text: 'Не группирую, делаю задачи в случайном порядке', score: 1 },
      { text: 'Иногда объединяю похожие дела', score: 2 },
      { text: 'Стараюсь группировать однотипные задачи', score: 3 },
      { text: 'Всегда группирую задачи для максимальной эффективности', score: 4 }
    ]
  },
  {
    id: '14',
    text: 'Насколько эффективно вы используете "мертвое" время (поездки, ожидание)?',
    options: [
      { text: 'Никак не использую это время', score: 1 },
      { text: 'Редко использую продуктивно', score: 2 },
      { text: 'Иногда планирую дела на это время', score: 3 },
      { text: 'Всегда максимально использую любое свободное время', score: 4 }
    ]
  },
  {
    id: '15',
    text: 'Как часто вы пересматриваете и корректируете свои планы?',
    options: [
      { text: 'Никогда не пересматриваю', score: 1 },
      { text: 'Редко корректирую планы', score: 2 },
      { text: 'Периодически пересматриваю планы', score: 3 },
      { text: 'Регулярно анализирую и улучшаю систему планирования', score: 4 }
    ]
  }
];

export const calculateTimeManagementResult = (answers: Record<string, number>): TimeManagementResult => {
  const totalScore = Object.values(answers).reduce((sum, score) => sum + score, 0);
  const maxScore = 60;
  const percentage = Math.round((totalScore / maxScore) * 100);
  
  let level: 'poor' | 'developing' | 'good' | 'excellent';
  let title: string;
  let description: string;
  let strengths: string[];
  let weaknesses: string[];
  let recommendations: string[];
  let techniques: string[];
  let tools: string[];

  if (totalScore <= 25) {
    level = 'poor';
    title = 'Слабые навыки управления временем';
    description = 'У вас низкий уровень навыков управления временем. Отсутствие планирования и системы приоритетов создает хаос и снижает продуктивность. Необходимо кардинально пересмотреть подход к организации времени.';
    strengths = ['Потенциал для значительного улучшения', 'Осознание проблемы'];
    weaknesses = [
      'Отсутствие планирования',
      'Неумение расставлять приоритеты',
      'Частые отвлечения',
      'Плохая оценка времени',
      'Хаотичный подход к задачам'
    ];
    techniques = [
      'Метод SMART для постановки целей',
      'Простое ежедневное планирование',
      'Правило "съешь лягушку" - самое важное дело утром',
      'Метод "двух минут" для мелких задач'
    ];
    tools = [
      'Простой бумажный планер',
      'Календарь на телефоне',
      'Список дел (ToDo приложение)',
      'Таймер для отслеживания времени'
    ];
  } else if (totalScore <= 35) {
    level = 'developing';
    title = 'Развивающиеся навыки управления временем';
    description = 'Ваши навыки управления временем находятся в процессе развития. Вы понимаете важность планирования, но не всегда применяете это на практике. С небольшими усилиями можете значительно улучшить свою эффективность.';
    strengths = [
      'Понимание важности планирования',
      'Периодическое использование приоритетов',
      'Базовые навыки организации'
    ];
    weaknesses = [
      'Непоследовательность в планировании',
      'Недооценка времени на задачи',
      'Частые отвлечения',
      'Слабая система приоритетов'
    ];
    techniques = [
      'Матрица Эйзенхауэра для приоритетов',
      'Техника "Помидора" для концентрации',
      'Еженедельное планирование',
      'Группировка похожих задач'
    ];
    tools = [
      'Календарное приложение',
      'Трекер времени',
      'Простая система GTD',
      'Приложения для блокировки отвлекающих сайтов'
    ];
  } else if (totalScore <= 45) {
    level = 'good';
    title = 'Хорошие навыки управления временем';
    description = 'У вас хорошие навыки управления временем. Вы планируете свою деятельность, умеете расставлять приоритеты и в основном справляетесь с задачами в срок. Есть возможности для дальнейшего совершенствования.';
    strengths = [
      'Регулярное планирование',
      'Понимание приоритетов',
      'Соблюдение дедлайнов',
      'Использование инструментов планирования',
      'Контроль над отвлечениями'
    ];
    weaknesses = [
      'Иногда неточная оценка времени',
      'Периодические отвлечения',
      'Не всегда оптимальное использование времени'
    ];
    techniques = [
      'Система GTD (Getting Things Done)',
      'Планирование по методу "буферного времени"',
      'Энергетическое планирование',
      'Метод временных блоков'
    ];
    tools = [
      'Продвинутые приложения для планирования',
      'Автоматизация рутинных задач',
      'Интеграция различных систем',
      'Аналитика времени'
    ];
  } else {
    level = 'excellent';
    title = 'Отличные навыки управления временем';
    description = 'У вас превосходные навыки управления временем. Вы мастерски планируете, эффективно расставляете приоритеты и оптимально используете каждую минуту. Ваши навыки могут служить примером для других.';
    strengths = [
      'Мастерское планирование',
      'Четкие приоритеты',
      'Высокая концентрация',
      'Эффективные системы',
      'Постоянное совершенствование',
      'Баланс работы и отдыха'
    ];
    weaknesses = ['Минимальные области для улучшения'];
    techniques = [
      'Индивидуальная система продуктивности',
      'Стратегическое планирование',
      'Делегирование и аутсорсинг',
      'Постоянная оптимизация процессов'
    ];
    tools = [
      'Интегрированная экосистема приложений',
      'Автоматизация и искусственный интеллект',
      'Продвинутая аналитика',
      'Персонализированные решения'
    ];
  }

  // Общие рекомендации
  recommendations = [
    'Начните с простого ежедневного планирования',
    'Определите свои пиковые часы продуктивности',
    'Устраните главные источники отвлечений',
    'Научитесь говорить "нет" неприоритетным задачам',
    'Регулярно анализируйте и корректируйте свой подход'
  ];

  if (level === 'poor') {
    recommendations.unshift(
      'Немедленно внедрите базовые привычки планирования',
      'Выберите одну простую систему и следуйте ей'
    );
  } else if (level === 'excellent') {
    recommendations.push(
      'Поделитесь опытом с другими',
      'Станьте ментором по продуктивности'
    );
  }

  return {
    level,
    score: totalScore,
    percentage,
    title,
    description,
    strengths,
    weaknesses,
    recommendations,
    techniques,
    tools
  };
};