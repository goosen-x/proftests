/**
 * Тест на хронотип (жаворонок или сова)
 * Определяет естественные биоритмы и оптимальное время активности
 */

export interface ChronotypeQuestion {
  id: string;
  text: string;
  options: {
    text: string;
    score: number; // -3 (сова) до +3 (жаворонок)
  }[];
}

export interface ChronotypeResult {
  type: 'extreme_lark' | 'moderate_lark' | 'intermediate' | 'moderate_owl' | 'extreme_owl';
  score: number; // от -45 до +45
  percentage: number; // 0-100
  title: string;
  description: string;
  optimal_schedule: {
    wake_time: string;
    sleep_time: string;
    peak_performance: string;
    exercise_time: string;
    creative_time: string;
  };
  characteristics: string[];
  advantages: string[];
  challenges: string[];
  health_tips: string[];
  career_recommendations: string[];
  famous_people: string[];
}

export const chronotypeQuestions: ChronotypeQuestion[] = [
  {
    id: '1',
    text: 'В какое время вы предпочитаете просыпаться в выходные дни?',
    options: [
      { text: 'До 6:00', score: 3 },
      { text: '6:00-7:00', score: 2 },
      { text: '7:00-9:00', score: 1 },
      { text: '9:00-11:00', score: 0 },
      { text: '11:00-12:00', score: -1 },
      { text: 'После 12:00', score: -2 },
    ],
  },
  {
    id: '2',
    text: 'В какое время вы чувствуете наибольший прилив энергии?',
    options: [
      { text: '5:00-8:00 утра', score: 3 },
      { text: '8:00-10:00 утра', score: 2 },
      { text: '10:00-17:00', score: 1 },
      { text: '17:00-20:00', score: 0 },
      { text: '20:00-23:00', score: -1 },
      { text: '23:00-2:00', score: -2 },
      { text: '2:00-5:00', score: -3 },
    ],
  },
  {
    id: '3',
    text: 'Во сколько вы обычно ложитесь спать?',
    options: [
      { text: 'До 21:00', score: 3 },
      { text: '21:00-22:00', score: 2 },
      { text: '22:00-23:00', score: 1 },
      { text: '23:00-24:00', score: 0 },
      { text: '24:00-1:00', score: -1 },
      { text: '1:00-2:00', score: -2 },
      { text: 'После 2:00', score: -3 },
    ],
  },
  {
    id: '4',
    text: 'Насколько сложно вам вставать рано утром?',
    options: [
      { text: 'Очень легко, просыпаюсь сам', score: 3 },
      { text: 'Довольно легко', score: 2 },
      { text: 'Не очень сложно', score: 1 },
      { text: 'Довольно сложно', score: 0 },
      { text: 'Очень сложно', score: -1 },
      { text: 'Практически невозможно', score: -2 },
    ],
  },
  {
    id: '5',
    text: 'Как вы чувствуете себя в первый час после пробуждения?',
    options: [
      { text: 'Очень бодро и энергично', score: 3 },
      { text: 'Довольно бодро', score: 2 },
      { text: 'Нормально', score: 1 },
      { text: 'Немного вяло', score: 0 },
      { text: 'Очень вяло', score: -1 },
      { text: 'Практически не могу функционировать', score: -2 },
    ],
  },
  {
    id: '6',
    text: 'В какое время дня вы чувствуете себя наиболее творческим?',
    options: [
      { text: 'Рано утром (5:00-9:00)', score: 3 },
      { text: 'Утром (9:00-12:00)', score: 2 },
      { text: 'Днем (12:00-17:00)', score: 1 },
      { text: 'Вечером (17:00-21:00)', score: 0 },
      { text: 'Поздно вечером (21:00-24:00)', score: -1 },
      { text: 'Ночью (после 24:00)', score: -2 },
    ],
  },
  {
    id: '7',
    text: 'Когда вы предпочитаете заниматься спортом?',
    options: [
      { text: 'Рано утром (6:00-8:00)', score: 3 },
      { text: 'Утром (8:00-11:00)', score: 2 },
      { text: 'Днем (11:00-17:00)', score: 1 },
      { text: 'Вечером (17:00-20:00)', score: 0 },
      { text: 'Поздно вечером (20:00-23:00)', score: -1 },
      { text: 'Ночью (после 23:00)', score: -2 },
    ],
  },
  {
    id: '8',
    text: 'Во сколько вы предпочитаете ужинать?',
    options: [
      { text: '17:00-18:00', score: 2 },
      { text: '18:00-19:00', score: 1 },
      { text: '19:00-20:00', score: 0 },
      { text: '20:00-21:00', score: -1 },
      { text: '21:00-22:00', score: -2 },
      { text: 'После 22:00', score: -3 },
    ],
  },
  {
    id: '9',
    text: 'Если бы вы могли выбирать, в какое время сдавать важный экзамен?',
    options: [
      { text: '8:00-10:00', score: 3 },
      { text: '10:00-13:00', score: 2 },
      { text: '13:00-15:00', score: 1 },
      { text: '15:00-18:00', score: 0 },
      { text: '18:00-21:00', score: -1 },
      { text: 'После 21:00', score: -2 },
    ],
  },
  {
    id: '10',
    text: 'Как быстро вы засыпаете?',
    options: [
      { text: 'Очень быстро (менее 10 минут)', score: 2 },
      { text: 'Довольно быстро (10-20 минут)', score: 1 },
      { text: 'Умеренно (20-40 минут)', score: 0 },
      { text: 'Долго (40-60 минут)', score: -1 },
      { text: 'Очень долго (более часа)', score: -2 },
    ],
  },
  {
    id: '11',
    text: 'Насколько вы продуктивны в первой половине дня?',
    options: [
      { text: 'Максимально продуктивен', score: 3 },
      { text: 'Довольно продуктивен', score: 2 },
      { text: 'Умеренно продуктивен', score: 1 },
      { text: 'Малопродуктивен', score: 0 },
      { text: 'Совсем не продуктивен', score: -1 },
      { text: 'Практически не функционирую', score: -2 },
    ],
  },
  {
    id: '12',
    text: 'Если бы не было никаких обязательств, во сколько вы бы ложились спать?',
    options: [
      { text: 'До 20:00', score: 3 },
      { text: '20:00-21:00', score: 2 },
      { text: '21:00-22:00', score: 1 },
      { text: '22:00-24:00', score: 0 },
      { text: '24:00-2:00', score: -1 },
      { text: '2:00-4:00', score: -2 },
      { text: 'После 4:00', score: -3 },
    ],
  },
  {
    id: '13',
    text: 'Когда вы чувствуете наибольшую потребность в кофеине?',
    options: [
      { text: 'Не нуждаюсь в кофеине', score: 2 },
      { text: 'Утром для поддержания энергии', score: 1 },
      { text: 'В течение всего дня', score: 0 },
      { text: 'Днем и вечером', score: -1 },
      { text: 'В основном вечером и ночью', score: -2 },
    ],
  },
  {
    id: '14',
    text: 'В отпуске, без будильника, на сколько часов сдвигается ваш режим сна?',
    options: [
      { text: 'Не сдвигается или ложусь раньше', score: 3 },
      { text: 'Сдвигается на 30-60 минут позже', score: 2 },
      { text: 'Сдвигается на 1-2 часа позже', score: 1 },
      { text: 'Сдвигается на 2-3 часа позже', score: 0 },
      { text: 'Сдвигается на 3-4 часа позже', score: -1 },
      { text: 'Сдвигается более чем на 4 часа', score: -2 },
    ],
  },
  {
    id: '15',
    text: 'Как вы себя чувствуете при смене часовых поясов?',
    options: [
      { text: 'Легко адаптируюсь к любым изменениям', score: 2 },
      { text: 'Быстро адаптируюсь при полете на восток', score: 1 },
      { text: 'Адаптируюсь одинаково в обоих направлениях', score: 0 },
      { text: 'Легче адаптируюсь при полете на запад', score: -1 },
      { text: 'Очень тяжело переношу смену часовых поясов', score: -2 },
    ],
  },
];

export const calculateChronotypeResult = (answers: Record<string, number>): ChronotypeResult => {
  const totalScore = Object.values(answers).reduce((sum, score) => sum + score, 0);
  const maxScore = 45;
  const minScore = -45;

  // Нормализуем процент от 0 до 100, где 0 = extreme owl, 100 = extreme lark
  const percentage = Math.round(((totalScore - minScore) / (maxScore - minScore)) * 100);

  let type: 'extreme_lark' | 'moderate_lark' | 'intermediate' | 'moderate_owl' | 'extreme_owl';
  let title: string;
  let description: string;
  let optimal_schedule: {
    wake_time: string;
    sleep_time: string;
    peak_performance: string;
    exercise_time: string;
    creative_time: string;
  };
  let characteristics: string[];
  let advantages: string[];
  let challenges: string[];
  let health_tips: string[];
  let career_recommendations: string[];
  let famous_people: string[];

  if (totalScore >= 25) {
    type = 'extreme_lark';
    title = 'Выраженный жаворонок';
    description =
      'Вы - ярко выраженный жаворонок. Ваши биологические часы настроены на раннее пробуждение и активность в утренние часы. Вы максимально продуктивны в первой половине дня и естественно засыпаете рано вечером.';
    optimal_schedule = {
      wake_time: '5:00-6:00',
      sleep_time: '21:00-22:00',
      peak_performance: '8:00-12:00',
      exercise_time: '6:00-8:00',
      creative_time: '7:00-11:00',
    };
    characteristics = [
      'Легко просыпаетесь рано утром',
      'Максимальная энергия до полудня',
      'Естественное желание лечь спать до 22:00',
      'Отличное настроение с утра',
      'Предпочитаете завтракать рано и плотно',
    ];
    advantages = [
      'Высокая утренняя продуктивность',
      'Лучшая дисциплина и самоконтроль',
      'Соответствие большинству рабочих графиков',
      'Больше времени для утренних ритуалов',
      'Лучшее качество сна',
    ];
    challenges = [
      'Трудности с вечерними мероприятиями',
      'Снижение работоспособности после обеда',
      'Социальные ограничения из-за раннего сна',
      'Сложности в работе в команде с "совами"',
    ];
    health_tips = [
      'Получайте много света утром',
      'Избегайте кофеина после 14:00',
      'Планируйте важные дела на утро',
      'Ужинайте не позднее 19:00',
      'Создайте ритуал отхода ко сну',
    ];
    career_recommendations = [
      'Работа с раннего утра',
      'Руководящие позиции',
      'Медицина (утренние смены)',
      'Финансы и банковское дело',
      'Образование',
      'Спорт и фитнес-тренировки',
    ];
    famous_people = ['Тим Кук', 'Ричард Брэнсон', 'Джек Дорси', 'Анна Винтур', 'Дуэйн Джонсон'];
  } else if (totalScore >= 10) {
    type = 'moderate_lark';
    title = 'Умеренный жаворонок';
    description =
      'Вы - умеренный жаворонок. У вас есть склонность к утренней активности, но вы более гибки в своем расписании, чем выраженные жаворонки. Вы можете адаптироваться к различным режимам дня.';
    optimal_schedule = {
      wake_time: '6:00-7:00',
      sleep_time: '22:00-23:00',
      peak_performance: '9:00-13:00',
      exercise_time: '7:00-9:00',
      creative_time: '8:00-12:00',
    };
    characteristics = [
      'Предпочитаете утреннюю активность',
      'Хорошая адаптация к разным режимам',
      'Продуктивны в первой половине дня',
      'Можете работать и вечером при необходимости',
    ];
    advantages = [
      'Гибкость в расписании',
      'Хорошая утренняя энергия',
      'Способность к адаптации',
      'Баланс между утренней и дневной активностью',
    ];
    challenges = [
      'Легкое снижение энергии к вечеру',
      'Необходимость поддерживать режим',
      'Иногда трудно работать поздно',
    ];
    health_tips = [
      'Поддерживайте стабильный режим сна',
      'Используйте утренний свет для энергии',
      'Планируйте сложные задачи на утро',
      'Делайте перерывы во второй половине дня',
    ];
    career_recommendations = [
      'Менеджмент и административная работа',
      'Консалтинг',
      'Продажи',
      'Образование',
      'Здравоохранение',
      'Традиционные офисные профессии',
    ];
    famous_people = [
      'Барак Обама',
      'Опра Уинфри',
      'Джефф Безос',
      'Шерил Сэндберг',
      'Уоррен Баффетт',
    ];
  } else if (totalScore >= -10) {
    type = 'intermediate';
    title = 'Промежуточный тип';
    description =
      'Вы - промежуточный тип или "голубь". У вас сбалансированные биоритмы, и вы можете быть продуктивны как утром, так и вечером. Это самый распространенный хронотип.';
    optimal_schedule = {
      wake_time: '7:00-8:00',
      sleep_time: '23:00-24:00',
      peak_performance: '10:00-16:00',
      exercise_time: '8:00-10:00 или 17:00-19:00',
      creative_time: '10:00-14:00',
    };
    characteristics = [
      'Гибкие биоритмы',
      'Продуктивность в течение всего дня',
      'Адаптация к разным режимам',
      'Умеренная потребность во сне',
    ];
    advantages = [
      'Максимальная гибкость расписания',
      'Хорошая адаптация к изменениям',
      'Продуктивность в разное время',
      'Легкая социализация с разными хронотипами',
    ];
    challenges = [
      'Отсутствие ярко выраженных пиков энергии',
      'Необходимость экспериментировать с режимом',
      'Риск нарушения баланса',
    ];
    health_tips = [
      'Экспериментируйте с расписанием',
      'Следите за своими естественными ритмами',
      'Поддерживайте регулярность сна',
      'Используйте свою гибкость как преимущество',
    ];
    career_recommendations = [
      'Любые профессии с гибким графиком',
      'Креативные индустрии',
      'IT и технологии',
      'Маркетинг',
      'Управление проектами',
      'Freelance работа',
    ];
    famous_people = [
      'Билл Гейтс',
      'Стив Возняк',
      'Марк Кьюбан',
      'Ариана Хаффингтон',
      'Ричард Брэнсон',
    ];
  } else if (totalScore >= -25) {
    type = 'moderate_owl';
    title = 'Умеренная сова';
    description =
      'Вы - умеренная сова. Вы предпочитаете более позднее время для активности и лучше всего функционируете во второй половине дня и вечером. При этом вы можете адаптироваться к утренним обязательствам.';
    optimal_schedule = {
      wake_time: '8:00-9:00',
      sleep_time: '24:00-1:00',
      peak_performance: '14:00-20:00',
      exercise_time: '18:00-20:00',
      creative_time: '16:00-22:00',
    };
    characteristics = [
      'Медленное пробуждение утром',
      'Пик активности во второй половине дня',
      'Комфортно работать до позднего вечера',
      'Лучшая концентрация после обеда',
    ];
    advantages = [
      'Высокая вечерняя продуктивность',
      'Творческий подъем в вечерние часы',
      'Способность работать в нестандартное время',
      'Меньше конкуренции за вечерние ресурсы',
    ];
    challenges = [
      'Трудности с ранними встречами',
      'Низкая утренняя энергия',
      'Сложности с традиционным рабочим графиком',
      'Социальное давление "раннего общества"',
    ];
    health_tips = [
      'Используйте яркий свет вечером',
      'Постепенно сдвигайте режим при необходимости',
      'Планируйте важные дела на вторую половину дня',
      'Избегайте тяжелой пищи поздно вечером',
    ];
    career_recommendations = [
      'Творческие профессии',
      'IT и программирование',
      'Работа в вечернюю смену',
      'Freelance и удаленная работа',
      'Развлечения и медиа',
      'Ночная жизнь и гостеприимство',
    ];
    famous_people = [
      'Элон Маск',
      'Марк Цукерберг',
      'Джеймс Джойс',
      'Чарльз Дарвин',
      'Владимир Путин',
    ];
  } else {
    type = 'extreme_owl';
    title = 'Выраженная сова';
    description =
      'Вы - ярко выраженная сова. Ваши биологические часы сдвинуты к вечернему и ночному времени. Вы наиболее продуктивны поздно вечером и ночью, а утренние часы даются вам с большим трудом.';
    optimal_schedule = {
      wake_time: '9:00-11:00',
      sleep_time: '1:00-3:00',
      peak_performance: '16:00-24:00',
      exercise_time: '19:00-22:00',
      creative_time: '20:00-2:00',
    };
    characteristics = [
      'Очень тяжелое пробуждение утром',
      'Максимальная активность поздно вечером',
      'Естественное засыпание после полуночи',
      'Высокая креативность в ночные часы',
    ];
    advantages = [
      'Исключительная вечерняя и ночная продуктивность',
      'Высокий творческий потенциал',
      'Способность к глубокой концентрации',
      'Уникальная ниша в "ночных" профессиях',
    ];
    challenges = [
      'Серьезные трудности с утренними обязательствами',
      'Конфликт с социальными нормами',
      'Ограниченные карьерные возможности',
      'Проблемы со здоровьем при принуждении к раннему режиму',
    ];
    health_tips = [
      'Ищите работу с гибким или поздним графиком',
      'Используйте блокираторы синего света вечером',
      'Не принуждайте себя к раннему режиму',
      'Создайте темную среду для дневного сна при необходимости',
    ];
    career_recommendations = [
      'Программирование и IT',
      'Творческие профессии (писатель, художник)',
      'Ночные смены (охрана, медицина)',
      'Freelance работа',
      'Исследования и наука',
      'Развлечения и ночная индустрия',
    ];
    famous_people = [
      'Уинстон Черчилль',
      'Барак Обама',
      'Дарвин',
      'Хантер С. Томпсон',
      'Кит Ричардс',
    ];
  }

  return {
    type,
    score: totalScore,
    percentage,
    title,
    description,
    optimal_schedule,
    characteristics,
    advantages,
    challenges,
    health_tips,
    career_recommendations,
    famous_people,
  };
};
