/**
 * Тест на темперамент
 * Определяет тип темперамента по классификации Гиппократа-Павлова
 */

export interface TemperamentQuestion {
  id: string;
  text: string;
  options: {
    text: string;
    temperament: 'sanguine' | 'choleric' | 'melancholic' | 'phlegmatic';
  }[];
}

export interface TemperamentResult {
  primary_type: 'sanguine' | 'choleric' | 'melancholic' | 'phlegmatic';
  secondary_type?: 'sanguine' | 'choleric' | 'melancholic' | 'phlegmatic';
  scores: {
    sanguine: number;
    choleric: number;
    melancholic: number;
    phlegmatic: number;
  };
  title: string;
  description: string;
  characteristics: string[];
  strengths: string[];
  weaknesses: string[];
  suitable_careers: string[];
  relationship_style: string;
  learning_style: string;
  stress_response: string;
  famous_people: string[];
  recommendations: string[];
}

export const temperamentQuestions: TemperamentQuestion[] = [
  {
    id: '1',
    text: 'Как вы обычно реагируете на новые знакомства?',
    options: [
      { text: 'Легко завожу разговор, быстро становлюсь душой компании', temperament: 'sanguine' },
      { text: 'Активно знакомлюсь, стремлюсь произвести впечатление', temperament: 'choleric' },
      { text: 'Стесняюсь, предпочитаю сначала понаблюдать', temperament: 'melancholic' },
      { text: 'Веду себя спокойно, жду когда со мной заговорят', temperament: 'phlegmatic' }
    ]
  },
  {
    id: '2',
    text: 'Ваша реакция на стрессовые ситуации:',
    options: [
      { text: 'Стараюсь найти позитивные стороны, быстро переключаюсь', temperament: 'sanguine' },
      { text: 'Мобилизуюсь, начинаю активно действовать', temperament: 'choleric' },
      { text: 'Глубоко переживаю, анализирую ситуацию', temperament: 'melancholic' },
      { text: 'Остаюсь спокойным, жду пока ситуация разрешится', temperament: 'phlegmatic' }
    ]
  },
  {
    id: '3',
    text: 'Ваш стиль работы:',
    options: [
      { text: 'Работаю с энтузиазмом, но могу отвлекаться', temperament: 'sanguine' },
      { text: 'Работаю интенсивно, стремлюсь к результату', temperament: 'choleric' },
      { text: 'Работаю тщательно, уделяю внимание деталям', temperament: 'melancholic' },
      { text: 'Работаю методично, в своем темпе', temperament: 'phlegmatic' }
    ]
  },
  {
    id: '4',
    text: 'Как вы выражаете эмоции?',
    options: [
      { text: 'Открыто и ярко, эмоции читаются на лице', temperament: 'sanguine' },
      { text: 'Интенсивно, иногда бурно', temperament: 'choleric' },
      { text: 'Глубоко, но не всегда показываю', temperament: 'melancholic' },
      { text: 'Сдержанно, предпочитаю контролировать эмоции', temperament: 'phlegmatic' }
    ]
  },
  {
    id: '5',
    text: 'Ваше отношение к переменам:',
    options: [
      { text: 'Люблю новизну, легко адаптируюсь', temperament: 'sanguine' },
      { text: 'Принимаю, если перемены ведут к улучшению', temperament: 'choleric' },
      { text: 'Осторожно отношусь, нужно время для привыкания', temperament: 'melancholic' },
      { text: 'Предпочитаю стабильность, избегаю резких изменений', temperament: 'phlegmatic' }
    ]
  },
  {
    id: '6',
    text: 'В конфликтных ситуациях вы:',
    options: [
      { text: 'Стараюсь разрядить обстановку шуткой', temperament: 'sanguine' },
      { text: 'Активно отстаиваю свою позицию', temperament: 'choleric' },
      { text: 'Глубоко переживаю, долго анализирую', temperament: 'melancholic' },
      { text: 'Избегаю конфронтации, ищу компромисс', temperament: 'phlegmatic' }
    ]
  },
  {
    id: '7',
    text: 'Ваш темп жизни:',
    options: [
      { text: 'Быстрый, насыщенный событиями', temperament: 'sanguine' },
      { text: 'Интенсивный, целеустремленный', temperament: 'choleric' },
      { text: 'Размеренный, с глубоким погружением в дела', temperament: 'melancholic' },
      { text: 'Спокойный, стабильный', temperament: 'phlegmatic' }
    ]
  },
  {
    id: '8',
    text: 'Как вы принимаете решения?',
    options: [
      { text: 'Быстро, часто полагаюсь на интуицию', temperament: 'sanguine' },
      { text: 'Решительно, сразу перехожу к действиям', temperament: 'choleric' },
      { text: 'Тщательно взвешиваю все варианты', temperament: 'melancholic' },
      { text: 'Не спешу, консультируюсь с другими', temperament: 'phlegmatic' }
    ]
  },
  {
    id: '9',
    text: 'Ваше отношение к риску:',
    options: [
      { text: 'Легко иду на риск, если это интересно', temperament: 'sanguine' },
      { text: 'Рискую, если это приведет к успеху', temperament: 'choleric' },
      { text: 'Осторожен, тщательно просчитываю последствия', temperament: 'melancholic' },
      { text: 'Избегаю рисков, предпочитаю надежность', temperament: 'phlegmatic' }
    ]
  },
  {
    id: '10',
    text: 'В общении вы:',
    options: [
      { text: 'Общительный, легко нахожу общий язык', temperament: 'sanguine' },
      { text: 'Доминирую в разговоре, направляю беседу', temperament: 'choleric' },
      { text: 'Предпочитаю глубокие разговоры', temperament: 'melancholic' },
      { text: 'Хороший слушатель, терпеливый собеседник', temperament: 'phlegmatic' }
    ]
  },
  {
    id: '11',
    text: 'Ваша реакция на критику:',
    options: [
      { text: 'Воспринимаю легко, быстро забываю', temperament: 'sanguine' },
      { text: 'Защищаюсь, могу ответить резко', temperament: 'choleric' },
      { text: 'Болезненно переживаю, долго думаю об этом', temperament: 'melancholic' },
      { text: 'Выслушиваю спокойно, анализирую справедливость', temperament: 'phlegmatic' }
    ]
  },
  {
    id: '12',
    text: 'Как вы восстанавливаете энергию?',
    options: [
      { text: 'В компании друзей, развлечениях', temperament: 'sanguine' },
      { text: 'Через физическую активность, достижения', temperament: 'choleric' },
      { text: 'В одиночестве, творчестве, размышлениях', temperament: 'melancholic' },
      { text: 'В спокойной обстановке, рутинных занятиях', temperament: 'phlegmatic' }
    ]
  },
  {
    id: '13',
    text: 'Ваше отношение к планированию:',
    options: [
      { text: 'Планирую общие направления, детали импровизирую', temperament: 'sanguine' },
      { text: 'Составляю четкие планы для достижения целей', temperament: 'choleric' },
      { text: 'Планирую детально, учитываю множество факторов', temperament: 'melancholic' },
      { text: 'Предпочитаю готовые планы, следую проверенным схемам', temperament: 'phlegmatic' }
    ]
  },
  {
    id: '14',
    text: 'В группе людей вы чаще всего:',
    options: [
      { text: 'Развлекаю других, поднимаю настроение', temperament: 'sanguine' },
      { text: 'Беру на себя роль лидера', temperament: 'choleric' },
      { text: 'Наблюдаю, анализирую происходящее', temperament: 'melancholic' },
      { text: 'Поддерживаю других, создаю атмосферу уюта', temperament: 'phlegmatic' }
    ]
  },
  {
    id: '15',
    text: 'Ваш стиль одежды и внешний вид:',
    options: [
      { text: 'Яркий, модный, привлекающий внимание', temperament: 'sanguine' },
      { text: 'Стильный, подчеркивающий статус', temperament: 'choleric' },
      { text: 'Тщательно подобранный, соответствующий случаю', temperament: 'melancholic' },
      { text: 'Комфортный, практичный, неброский', temperament: 'phlegmatic' }
    ]
  },
  {
    id: '16',
    text: 'Когда вы злитесь:',
    options: [
      { text: 'Быстро вспыхиваю, но быстро остываю', temperament: 'sanguine' },
      { text: 'Выражаю гнев открыто и интенсивно', temperament: 'choleric' },
      { text: 'Переживаю глубоко, могу обижаться долго', temperament: 'melancholic' },
      { text: 'Редко выражаю гнев открыто, подавляю эмоции', temperament: 'phlegmatic' }
    ]
  },
  {
    id: '17',
    text: 'Ваше отношение к дисциплине и порядку:',
    options: [
      { text: 'Порядок не главное, главное - настроение', temperament: 'sanguine' },
      { text: 'Порядок нужен для эффективности', temperament: 'choleric' },
      { text: 'Очень ценю порядок и систематичность', temperament: 'melancholic' },
      { text: 'Предпочитаю стабильный, привычный порядок', temperament: 'phlegmatic' }
    ]
  },
  {
    id: '18',
    text: 'В работе над проектом вы:',
    options: [
      { text: 'Генерирую идеи, вдохновляю команду', temperament: 'sanguine' },
      { text: 'Организую процесс, контролирую выполнение', temperament: 'choleric' },
      { text: 'Обеспечиваю качество, прорабатываю детали', temperament: 'melancholic' },
      { text: 'Выполняю свою часть надежно и в срок', temperament: 'phlegmatic' }
    ]
  },
  {
    id: '19',
    text: 'Ваши хобби и интересы:',
    options: [
      { text: 'Разнообразные, часто меняются', temperament: 'sanguine' },
      { text: 'Связаны с соревнованиями, достижениями', temperament: 'choleric' },
      { text: 'Глубокие, требующие сосредоточенности', temperament: 'melancholic' },
      { text: 'Спокойные, не требующие спешки', temperament: 'phlegmatic' }
    ]
  },
  {
    id: '20',
    text: 'Ваша память лучше всего сохраняет:',
    options: [
      { text: 'Яркие, эмоциональные моменты', temperament: 'sanguine' },
      { text: 'Важную для достижения целей информацию', temperament: 'choleric' },
      { text: 'Детали, нюансы, глубокие впечатления', temperament: 'melancholic' },
      { text: 'Полезную, проверенную временем информацию', temperament: 'phlegmatic' }
    ]
  }
];

export const calculateTemperamentResult = (answers: Record<string, string>): TemperamentResult => {
  const scores = {
    sanguine: 0,
    choleric: 0,
    melancholic: 0,
    phlegmatic: 0
  };

  // Подсчитываем баллы для каждого темперамента
  Object.values(answers).forEach(temperament => {
    scores[temperament as keyof typeof scores]++;
  });

  // Определяем основной темперамент
  const primary_type = Object.entries(scores).reduce((a, b) => 
    scores[a[0] as keyof typeof scores] > scores[b[0] as keyof typeof scores] ? a : b
  )[0] as keyof typeof scores;

  // Определяем вторичный темперамент (если разница не слишком большая)
  const sortedScores = Object.entries(scores).sort((a, b) => b[1] - a[1]);
  const secondary_type = sortedScores[0][1] - sortedScores[1][1] <= 3 ? 
    sortedScores[1][0] as keyof typeof scores : undefined;

  const temperamentData = {
    sanguine: {
      title: 'Сангвиник',
      description: 'Вы - сангвиник, обладаете живым, подвижным характером. Вы оптимистичны, общительны и легко адаптируетесь к новым условиям. Ваша энергия и энтузиазм заражают окружающих.',
      characteristics: [
        'Жизнерадостный и оптимистичный',
        'Общительный и открытый',
        'Быстро переключается между делами',
        'Легко заводит новые знакомства',
        'Эмоционально выразительный',
        'Склонен к лидерству в компании',
        'Быстро восстанавливается после неудач'
      ],
      strengths: [
        'Высокая адаптивность',
        'Коммуникабельность',
        'Оптимизм и жизнерадостность',
        'Творческий подход к задачам',
        'Умение мотивировать других',
        'Стрессоустойчивость',
        'Гибкость мышления'
      ],
      weaknesses: [
        'Непостоянство в интересах',
        'Поверхностность в отношениях',
        'Склонность к необдуманным решениям',
        'Трудности с длительной концентрацией',
        'Может быть ненадежным в мелочах',
        'Избегает рутинной работы'
      ],
      suitable_careers: [
        'Менеджер по продажам',
        'PR-специалист',
        'Журналист',
        'Актер',
        'Тренер',
        'Организатор мероприятий',
        'Педагог',
        'Психолог',
        'Туристический агент'
      ],
      relationship_style: 'В отношениях вы ярки и романтичны, но можете быть непостоянны. Цените эмоциональную близость и веселье.',
      learning_style: 'Лучше всего учитесь в активном взаимодействии с другими, через обсуждения и практические упражнения.',
      stress_response: 'В стрессе становитесь еще более активными, ищете поддержку у друзей, быстро переключаетесь на позитив.',
      famous_people: ['Билл Клинтон', 'Робин Уильямс', 'Элтон Джон', 'Джим Керри', 'Опра Уинфри'],
      recommendations: [
        'Научитесь доводить дела до конца, используйте списки задач и напоминания',
        'Развивайте усидчивость через короткие сессии концентрации с перерывами',
        'Окружите себя организованными людьми, которые помогут структурировать вашу активность',
        'Используйте свою коммуникабельность для построения полезных связей',
        'Занимайтесь спортом или танцами для выхода избыточной энергии'
      ]
    },
    choleric: {
      title: 'Холерик',
      description: 'Вы - холерик, обладаете сильным, энергичным характером. Вы целеустремленны, амбициозны и готовы брать на себя ответственность. Ваша решительность помогает достигать поставленных целей.',
      characteristics: [
        'Энергичный и целеустремленный',
        'Решительный и волевой',
        'Быстро принимает решения',
        'Склонен к доминированию',
        'Нетерпелив к препятствиям',
        'Прямолинеен в общении',
        'Ориентирован на результат'
      ],
      strengths: [
        'Лидерские качества',
        'Высокая мотивация к достижениям',
        'Способность быстро принимать решения',
        'Организаторские способности',
        'Умение работать под давлением',
        'Инициативность',
        'Целеустремленность'
      ],
      weaknesses: [
        'Нетерпеливость',
        'Склонность к агрессии',
        'Может игнорировать мнения других',
        'Трудности с деталями',
        'Может быть слишком требовательным',
        'Склонность к стрессу и переработке'
      ],
      suitable_careers: [
        'Руководитель',
        'Предприниматель',
        'Хирург',
        'Адвокат',
        'Военный',
        'Инвестор',
        'Продюсер',
        'Спортивный тренер',
        'Политик'
      ],
      relationship_style: 'В отношениях вы страстны и требовательны, цените партнеров, которые разделяют ваши амбиции.',
      learning_style: 'Предпочитаете активное обучение с четкими целями и практическим применением знаний.',
      stress_response: 'В стрессе становитесь более агрессивными и требовательными, склонны к конфронтации.',
      famous_people: ['Стив Джобс', 'Маргарет Тэтчер', 'Наполеон Бонапарт', 'Дональд Трамп', 'Гордон Рэмзи'],
      recommendations: [
        'Учитесь делегировать задачи и доверять команде',
        'Развивайте терпение и эмпатию к окружающим',
        'Планируйте время для отдыха и восстановления сил',
        'Практикуйте техники управления гневом и стрессом',
        'Цените процесс не меньше результата'
      ]
    },
    melancholic: {
      title: 'Меланхолик',
      description: 'Вы - меланхолик, обладаете глубоким, чувствительным характером. Вы вдумчивы, перфекционистичны и цените качество во всем. Ваша способность к глубокому анализу - ваша сильная сторона.',
      characteristics: [
        'Глубокий и вдумчивый',
        'Чувствительный к деталям',
        'Склонен к перфекционизму',
        'Осторожен в принятии решений',
        'Эмоционально глубокий',
        'Предпочитает стабильность',
        'Высокие стандарты качества'
      ],
      strengths: [
        'Аналитическое мышление',
        'Внимание к деталям',
        'Высокое качество работы',
        'Эмпатия и понимание других',
        'Творческие способности',
        'Надежность и ответственность',
        'Способность к глубоким отношениям'
      ],
      weaknesses: [
        'Склонность к пессимизму',
        'Чрезмерная самокритичность',
        'Долгое принятие решений',
        'Болезненная реакция на критику',
        'Склонность к тревожности',
        'Трудности с изменениями'
      ],
      suitable_careers: [
        'Ученый, исследователь',
        'Художник, дизайнер',
        'Писатель',
        'Психолог, психотерапевт',
        'Архитектор',
        'Программист',
        'Врач',
        'Музыкант',
        'Редактор'
      ],
      relationship_style: 'В отношениях вы преданы и глубоки, ищете настоящую близость и понимание.',
      learning_style: 'Лучше всего учитесь самостоятельно, через чтение и глубокое изучение материала.',
      stress_response: 'В стрессе уходите в себя, склонны к самоанализу и переживаниям, нуждаетесь в поддержке.',
      famous_people: ['Альберт Эйнштейн', 'Винсент Ван Гог', 'Чарльз Дарвин', 'Федор Достоевский', 'Майкл Джексон'],
      recommendations: [
        'Развивайте позитивное мышление и самосострадание',
        'Ставьте реалистичные цели и празднуйте достижения',
        'Окружите себя поддерживающими людьми',
        'Используйте творчество как способ самовыражения',
        'Практикуйте медитацию и техники релаксации'
      ]
    },
    phlegmatic: {
      title: 'Флегматик',
      description: 'Вы - флегматик, обладаете спокойным, уравновешенным характером. Вы надежны, терпеливы и предпочитаете стабильность. Ваше спокойствие и рассудительность ценятся окружающими.',
      characteristics: [
        'Спокойный и уравновешенный',
        'Терпеливый и выносливый',
        'Надежный и постоянный',
        'Избегает конфликтов',
        'Медлителен в решениях',
        'Предпочитает рутину',
        'Эмоционально стабильный'
      ],
      strengths: [
        'Эмоциональная стабильность',
        'Надежность и постоянство',
        'Дипломатические способности',
        'Терпение и выносливость',
        'Умение работать в команде',
        'Хорошие аналитические способности',
        'Стрессоустойчивость'
      ],
      weaknesses: [
        'Медлительность в действиях',
        'Сопротивление изменениям',
        'Может быть пассивным',
        'Избегание конфронтации',
        'Недостаток инициативы',
        'Склонность к прокрастинации'
      ],
      suitable_careers: [
        'Бухгалтер',
        'Библиотекарь',
        'Администратор',
        'Медицинский работник',
        'Социальный работник',
        'Дипломат',
        'Инженер',
        'Педагог',
        'Аналитик'
      ],
      relationship_style: 'В отношениях вы стабильны и преданы, цените гармонию и избегаете конфликтов.',
      learning_style: 'Предпочитаете структурированное обучение с четкими инструкциями и достаточным временем.',
      stress_response: 'В стрессе сохраняете внешнее спокойствие, но можете уходить в себя и избегать проблем.',
      famous_people: ['Авраам Линкольн', 'Морган Фримен', 'Уоррен Баффетт', 'Мать Тереза', 'Киану Ривз'],
      recommendations: [
        'Развивайте инициативность и проактивность',
        'Выходите из зоны комфорта постепенно',
        'Ставьте дедлайны для принятия решений',
        'Занимайтесь активными видами спорта',
        'Учитесь выражать свои потребности и желания'
      ]
    }
  };

  const result = temperamentData[primary_type];

  return {
    primary_type,
    secondary_type,
    scores,
    title: result.title,
    description: result.description,
    characteristics: result.characteristics,
    strengths: result.strengths,
    weaknesses: result.weaknesses,
    suitable_careers: result.suitable_careers,
    relationship_style: result.relationship_style,
    learning_style: result.learning_style,
    stress_response: result.stress_response,
    famous_people: result.famous_people,
    recommendations: result.recommendations
  };
};