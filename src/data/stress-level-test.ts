/**
 * Тест на уровень стресса
 * Определяет текущий уровень стресса и дает рекомендации по его снижению
 */

export interface StressLevelQuestion {
  id: string;
  text: string;
  options: {
    text: string;
    score: number; // 0 (нет стресса) до 3 (высокий стресс)
  }[];
}

export interface StressLevelResult {
  level: 'low' | 'moderate' | 'high' | 'critical';
  score: number; // от 0 до 75
  percentage: number; // 0-100
  title: string;
  description: string;
  symptoms: string[];
  causes: string[];
  recommendations: string[];
  urgent_actions: string[];
  professional_help: boolean;
}

export const stressLevelQuestions: StressLevelQuestion[] = [
  {
    id: '1',
    text: 'Как часто вы чувствуете себя подавленным из-за количества дел?',
    options: [
      { text: 'Никогда', score: 0 },
      { text: 'Иногда', score: 1 },
      { text: 'Часто', score: 2 },
      { text: 'Постоянно', score: 3 }
    ]
  },
  {
    id: '2',
    text: 'Насколько часто у вас проблемы со сном?',
    options: [
      { text: 'Сплю отлично', score: 0 },
      { text: 'Иногда трудно заснуть', score: 1 },
      { text: 'Часто просыпаюсь ночью', score: 2 },
      { text: 'Страдаю от бессонницы', score: 3 }
    ]
  },
  {
    id: '3',
    text: 'Как часто вы чувствуете раздражительность или гнев?',
    options: [
      { text: 'Очень редко', score: 0 },
      { text: 'Иногда', score: 1 },
      { text: 'Несколько раз в неделю', score: 2 },
      { text: 'Ежедневно', score: 3 }
    ]
  },
  {
    id: '4',
    text: 'Насколько сложно вам концентрироваться на работе/учебе?',
    options: [
      { text: 'Легко концентрируюсь', score: 0 },
      { text: 'Иногда отвлекаюсь', score: 1 },
      { text: 'Часто трудно сосредоточиться', score: 2 },
      { text: 'Почти невозможно сконцентрироваться', score: 3 }
    ]
  },
  {
    id: '5',
    text: 'Как часто у вас болит голова?',
    options: [
      { text: 'Практически никогда', score: 0 },
      { text: 'Раз в месяц или реже', score: 1 },
      { text: 'Несколько раз в неделю', score: 2 },
      { text: 'Почти ежедневно', score: 3 }
    ]
  },
  {
    id: '6',
    text: 'Как изменился ваш аппетит в последнее время?',
    options: [
      { text: 'Без изменений, нормальный', score: 0 },
      { text: 'Незначительные изменения', score: 1 },
      { text: 'Значительно увеличился или уменьшился', score: 2 },
      { text: 'Полная потеря аппетита или переедание', score: 3 }
    ]
  },
  {
    id: '7',
    text: 'Насколько часто вы чувствуете тревогу о будущем?',
    options: [
      { text: 'Редко беспокоюсь', score: 0 },
      { text: 'Иногда тревожусь', score: 1 },
      { text: 'Часто волнуюсь', score: 2 },
      { text: 'Постоянно в тревоге', score: 3 }
    ]
  },
  {
    id: '8',
    text: 'Как часто вы чувствуете усталость без видимых причин?',
    options: [
      { text: 'Почти никогда', score: 0 },
      { text: 'Иногда', score: 1 },
      { text: 'Часто чувствую усталость', score: 2 },
      { text: 'Постоянно истощен', score: 3 }
    ]
  },
  {
    id: '9',
    text: 'Насколько трудно вам расслабиться после работы?',
    options: [
      { text: 'Легко расслабляюсь', score: 0 },
      { text: 'Нужно немного времени', score: 1 },
      { text: 'Трудно отключиться от работы', score: 2 },
      { text: 'Не могу расслабиться совсем', score: 3 }
    ]
  },
  {
    id: '10',
    text: 'Как часто вы чувствуете напряжение в мышцах (шея, плечи, спина)?',
    options: [
      { text: 'Редко или никогда', score: 0 },
      { text: 'Иногда', score: 1 },
      { text: 'Часто напрягаются мышцы', score: 2 },
      { text: 'Постоянное мышечное напряжение', score: 3 }
    ]
  },
  {
    id: '11',
    text: 'Насколько часто вы откладываете важные дела?',
    options: [
      { text: 'Почти никогда не откладываю', score: 0 },
      { text: 'Иногда откладываю', score: 1 },
      { text: 'Часто прокрастинирую', score: 2 },
      { text: 'Постоянно откладываю дела', score: 3 }
    ]
  },
  {
    id: '12',
    text: 'Как часто вас беспокоят проблемы с пищеварением?',
    options: [
      { text: 'Никогда', score: 0 },
      { text: 'Редко', score: 1 },
      { text: 'Периодически', score: 2 },
      { text: 'Постоянно', score: 3 }
    ]
  },
  {
    id: '13',
    text: 'Насколько часто вы чувствуете себя одиноким или изолированным?',
    options: [
      { text: 'Практически никогда', score: 0 },
      { text: 'Иногда', score: 1 },
      { text: 'Довольно часто', score: 2 },
      { text: 'Большую часть времени', score: 3 }
    ]
  },
  {
    id: '14',
    text: 'Как часто вы используете алкоголь или другие вещества для расслабления?',
    options: [
      { text: 'Никогда', score: 0 },
      { text: 'Очень редко', score: 1 },
      { text: 'Несколько раз в неделю', score: 2 },
      { text: 'Ежедневно или почти ежедневно', score: 3 }
    ]
  },
  {
    id: '15',
    text: 'Насколько часто вы чувствуете, что теряете контроль над ситуацией?',
    options: [
      { text: 'Почти никогда', score: 0 },
      { text: 'Иногда', score: 1 },
      { text: 'Довольно часто', score: 2 },
      { text: 'Большую часть времени', score: 3 }
    ]
  },
  {
    id: '16',
    text: 'Как изменилась ваша социальная активность?',
    options: [
      { text: 'Без изменений', score: 0 },
      { text: 'Немного уменьшилась', score: 1 },
      { text: 'Значительно сократилась', score: 2 },
      { text: 'Почти полностью избегаю людей', score: 3 }
    ]
  },
  {
    id: '17',
    text: 'Насколько часто у вас учащенное сердцебиение без физических нагрузок?',
    options: [
      { text: 'Никогда', score: 0 },
      { text: 'Редко', score: 1 },
      { text: 'Несколько раз в неделю', score: 2 },
      { text: 'Ежедневно', score: 3 }
    ]
  },
  {
    id: '18',
    text: 'Как часто вы чувствуете безнадежность?',
    options: [
      { text: 'Почти никогда', score: 0 },
      { text: 'Редко', score: 1 },
      { text: 'Иногда', score: 2 },
      { text: 'Часто или постоянно', score: 3 }
    ]
  },
  {
    id: '19',
    text: 'Насколько трудно вам принимать решения в последнее время?',
    options: [
      { text: 'Принимаю решения легко', score: 0 },
      { text: 'Иногда сомневаюсь', score: 1 },
      { text: 'Часто трудно решиться', score: 2 },
      { text: 'Практически не могу принимать решения', score: 3 }
    ]
  },
  {
    id: '20',
    text: 'Как часто вы думаете о том, что не справляетесь со своими обязанностями?',
    options: [
      { text: 'Практически никогда', score: 0 },
      { text: 'Иногда', score: 1 },
      { text: 'Довольно часто', score: 2 },
      { text: 'Постоянно', score: 3 }
    ]
  },
  {
    id: '21',
    text: 'Насколько часто вы чувствуете головокружение или слабость?',
    options: [
      { text: 'Никогда', score: 0 },
      { text: 'Редко', score: 1 },
      { text: 'Несколько раз в неделю', score: 2 },
      { text: 'Ежедневно', score: 3 }
    ]
  },
  {
    id: '22',
    text: 'Как часто вы забываете важные вещи или встречи?',
    options: [
      { text: 'Почти никогда', score: 0 },
      { text: 'Редко', score: 1 },
      { text: 'Довольно часто', score: 2 },
      { text: 'Постоянно что-то забываю', score: 3 }
    ]
  },
  {
    id: '23',
    text: 'Насколько часто вы чувствуете потребность плакать?',
    options: [
      { text: 'Очень редко', score: 0 },
      { text: 'Иногда', score: 1 },
      { text: 'Довольно часто', score: 2 },
      { text: 'Ежедневно или почти ежедневно', score: 3 }
    ]
  },
  {
    id: '24',
    text: 'Как часто вы чувствуете, что у вас нет времени на себя?',
    options: [
      { text: 'У меня достаточно личного времени', score: 0 },
      { text: 'Иногда не хватает времени', score: 1 },
      { text: 'Часто нет времени на себя', score: 2 },
      { text: 'Совершенно нет личного времени', score: 3 }
    ]
  },
  {
    id: '25',
    text: 'Насколько сложно вам наслаждаться вещами, которые раньше приносили удовольствие?',
    options: [
      { text: 'По-прежнему получаю удовольствие', score: 0 },
      { text: 'Иногда трудно наслаждаться', score: 1 },
      { text: 'Редко получаю удовольствие', score: 2 },
      { text: 'Ничто не приносит радости', score: 3 }
    ]
  }
];

export const calculateStressLevelResult = (answers: Record<string, number>): StressLevelResult => {
  const totalScore = Object.values(answers).reduce((sum, score) => sum + score, 0);
  const maxScore = 75;
  const percentage = Math.round((totalScore / maxScore) * 100);
  
  let level: 'low' | 'moderate' | 'high' | 'critical';
  let title: string;
  let description: string;
  let symptoms: string[];
  let causes: string[];
  let recommendations: string[];
  let urgent_actions: string[];
  let professional_help: boolean;

  if (totalScore <= 20) {
    level = 'low';
    title = 'Низкий уровень стресса';
    description = 'Поздравляем! У вас низкий уровень стресса. Вы хорошо справляетесь с жизненными вызовами и имеете эффективные механизмы преодоления трудностей. Продолжайте поддерживать здоровый баланс между работой и отдыхом.';
    symptoms = ['Хорошее настроение', 'Качественный сон', 'Стабильный аппетит', 'Высокая концентрация'];
    causes = ['Эффективное планирование времени', 'Здоровый образ жизни', 'Поддерживающее окружение'];
    recommendations = [
      'Продолжайте поддерживать текущий образ жизни',
      'Регулярно занимайтесь физическими упражнениями',
      'Поддерживайте социальные связи',
      'Практикуйте благодарность',
      'Изучайте новые техники релаксации профилактически'
    ];
    urgent_actions = [];
    professional_help = false;
  } else if (totalScore <= 35) {
    level = 'moderate';
    title = 'Умеренный уровень стресса';
    description = 'У вас умеренный уровень стресса. Это нормальная реакция на жизненные обстоятельства, но важно не позволить стрессу накапливаться. Сейчас самое время внедрить здоровые привычки управления стрессом.';
    symptoms = ['Периодическое напряжение', 'Иногда проблемы со сном', 'Небольшая раздражительность'];
    causes = ['Рабочие дедлайны', 'Семейные обязанности', 'Финансовые переживания'];
    recommendations = [
      'Внедрите ежедневные техники релаксации (медитация, глубокое дыхание)',
      'Улучшите планирование времени',
      'Больше времени проводите на свежем воздухе',
      'Ограничьте потребление кофеина',
      'Найдите хобби для расслабления',
      'Обратитесь за поддержкой к близким'
    ];
    urgent_actions = ['Начните практиковать техники дыхания', 'Установите границы в работе'];
    professional_help = false;
  } else if (totalScore <= 55) {
    level = 'high';
    title = 'Высокий уровень стресса';
    description = 'У вас высокий уровень стресса, который может негативно влиять на ваше физическое и психическое здоровье. Необходимо принять активные меры для снижения стресса и, возможно, обратиться за профессиональной помощью.';
    symptoms = ['Частые головные боли', 'Проблемы со сном', 'Раздражительность', 'Усталость', 'Проблемы с концентрацией'];
    causes = ['Хронический рабочий стресс', 'Личные проблемы', 'Отсутствие поддержки', 'Плохие привычки преодоления'];
    recommendations = [
      'Немедленно внедрите ежедневные практики снижения стресса',
      'Пересмотрите свои приоритеты и обязанности',
      'Изучите техники управления временем',
      'Начните регулярно заниматься спортом',
      'Ограничьте стрессогенные факторы',
      'Рассмотрите возможность консультации с психологом'
    ];
    urgent_actions = [
      'Немедленно начните практиковать глубокое дыхание',
      'Возьмите выходной день для восстановления',
      'Обратитесь за поддержкой к близким людям'
    ];
    professional_help = true;
  } else {
    level = 'critical';
    title = 'Критический уровень стресса';
    description = 'У вас критически высокий уровень стресса, который серьезно влияет на ваше здоровье и качество жизни. Настоятельно рекомендуется немедленно обратиться к специалисту по психическому здоровью.';
    symptoms = ['Постоянная тревога', 'Серьезные проблемы со сном', 'Депрессивное настроение', 'Физические симптомы', 'Панические атаки'];
    causes = ['Хроническое переутомление', 'Травматические события', 'Отсутствие поддержки', 'Накопленный стресс'];
    recommendations = [
      'НЕМЕДЛЕННО обратитесь к психологу или психотерапевту',
      'Рассмотрите возможность медицинского обследования',
      'Временно снизьте рабочую нагрузку',
      'Попросите помощи у близких',
      'Начните принимать антистрессовые меры прямо сейчас'
    ];
    urgent_actions = [
      'Запишитесь на прием к психологу на этой неделе',
      'Поговорите с руководством о снижении нагрузки',
      'Обратитесь за поддержкой к семье и друзьям',
      'При суицидальных мыслях - немедленно обратитесь в службу экстренной помощи'
    ];
    professional_help = true;
  }

  return {
    level,
    score: totalScore,
    percentage,
    title,
    description,
    symptoms,
    causes,
    recommendations,
    urgent_actions,
    professional_help
  };
};